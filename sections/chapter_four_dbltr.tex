\chapter{Role-based debloating for web applications}
\label{chap:dbltr}

\section*{Preamble}
Different users use the same web application differently. 
Based on this intuition, we explored a new approach to debloating, that is, to customize the debloating of web applications, for users with similar usage profile. 
Historically, RBAC (Role Based Access Control) mechanisms have provided the ability for system administrators to allow users to only access the subset of features that they need. 
Unsurprisingly, implementations of RBAC are not free of flaws~\cite{doupe2011fear, dalton2009nemesis, wpfilemanager}. 
Moreover, the over-authorization of users further increases the impact of insider attacks and compromised accounts~\cite{twitterviphack, oktahack}.

To address these challenges, we start by building a real-world ground truth dataset of web application usage patterns in the form of code-coverage information through a user study including 60 experienced administrators and developers. 
We then build a clustering model that incorporates features from the source code of applications to identify users with similar usage patterns and group them together under a dynamically-defined role. 

We design and implement \dbltr{} which consists of a reverse-proxy that is capable of hooking into the authentication attempts and transparently routing users towards role-specific custom debloated web applications. 
Finally, we evaluate the security benefits of this approach and demonstrate its ability to protect web applications against 30-80\% more of the known CVEs and shrink their attack surface further than the global debloating schemes such as ``Less is More'' (Chapter~\ref{chap:lim}). 

% Introduction
\input{sections/dbltr/introduction.tex}
% Background
\input{sections/dbltr/background.tex}
% User Study
\input{sections/dbltr/userstudy.tex}
% System Design
\input{sections/dbltr/systemdesign.tex}
% Debloating Results
\input{sections/dbltr/debloatingresults.tex}
% Discussion
\input{sections/dbltr/discussion.tex}
% Conclusion
\input{sections/dbltr/conclusion.tex}